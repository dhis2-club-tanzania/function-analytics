<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>utilities/fetcher.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="Fn.html">Fn</a><ul class='methods'><li data-type='method'><a href="Fn.html#.all">all</a></li><li data-type='method'><a href="Fn.html#.init">init</a></li></ul></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-Analytics_.html">Analytics</a><ul class='methods'><li data-type='method'><a href="Analytics.html#get">get</a></li><li data-type='method'><a href="Analytics.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="Analytics.html#getSanitizedAnalyticsMetadata">getSanitizedAnalyticsMetadata</a></li><li data-type='method'><a href="Analytics.html#setData">setData</a></li><li data-type='method'><a href="Analytics.html#setDimension">setDimension</a></li><li data-type='method'><a href="Analytics.html#setOrgUnit">setOrgUnit</a></li><li data-type='method'><a href="Analytics.html#setParameters">setParameters</a></li><li data-type='method'><a href="Analytics.html#setPeriod">setPeriod</a></li><li data-type='method'><a href="Analytics.html#setSelections">setSelections</a></li><li data-type='method'><a href="Analytics.html#standardizeAnalytics">standardizeAnalytics</a></li></ul></li><li><a href="tutorial-Generic-Functions.html">Generic-Functions</a></li></ul><h3>Classes</h3><ul><li><a href="Analytics.html">Analytics</a><ul class='methods'><li data-type='method'><a href="Analytics.html#get">get</a></li><li data-type='method'><a href="Analytics.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="Analytics.html#getSanitizedAnalyticsMetadata">getSanitizedAnalyticsMetadata</a></li><li data-type='method'><a href="Analytics.html#setData">setData</a></li><li data-type='method'><a href="Analytics.html#setDimension">setDimension</a></li><li data-type='method'><a href="Analytics.html#setOrgUnit">setOrgUnit</a></li><li data-type='method'><a href="Analytics.html#setParameters">setParameters</a></li><li data-type='method'><a href="Analytics.html#setPeriod">setPeriod</a></li><li data-type='method'><a href="Analytics.html#setSelections">setSelections</a></li><li data-type='method'><a href="Analytics.html#standardizeAnalytics">standardizeAnalytics</a></li></ul></li><li><a href="AnalyticsHeader.html">AnalyticsHeader</a></li><li><a href="AnalyticsHeaders.html">AnalyticsHeaders</a><ul class='methods'><li data-type='method'><a href="AnalyticsHeaders.html#getHeader">getHeader</a></li></ul></li><li><a href="AnalyticsResult.html">AnalyticsResult</a><ul class='methods'><li data-type='method'><a href="AnalyticsResult.html#getDimensionDetails">getDimensionDetails</a></li><li data-type='method'><a href="AnalyticsResult.html#getDimensionDetailsByName">getDimensionDetailsByName</a></li></ul></li><li><a href="Dependency.html">Dependency</a></li><li><a href="EventAnalytics.html">EventAnalytics</a><ul class='methods'><li data-type='method'><a href="EventAnalytics.html#get">get</a></li><li data-type='method'><a href="EventAnalytics.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="EventAnalytics.html#getSanitizedAnalyticsMetadata">getSanitizedAnalyticsMetadata</a></li><li data-type='method'><a href="EventAnalytics.html#setData">setData</a></li><li data-type='method'><a href="EventAnalytics.html#setDimension">setDimension</a></li><li data-type='method'><a href="EventAnalytics.html#setOrgUnit">setOrgUnit</a></li><li data-type='method'><a href="EventAnalytics.html#setParameters">setParameters</a></li><li data-type='method'><a href="EventAnalytics.html#setPeriod">setPeriod</a></li><li data-type='method'><a href="EventAnalytics.html#setProgram">setProgram</a></li><li data-type='method'><a href="EventAnalytics.html#setSelections">setSelections</a></li><li data-type='method'><a href="EventAnalytics.html#standardizeAnalytics">standardizeAnalytics</a></li></ul></li><li><a href="Fetcher.html">Fetcher</a><ul class='methods'><li data-type='method'><a href="Fetcher.html#addPostProcess">addPostProcess</a></li><li data-type='method'><a href="Fetcher.html#addPreProcess">addPreProcess</a></li><li data-type='method'><a href="Fetcher.html#get">get</a></li><li data-type='method'><a href="Fetcher.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="Fetcher.html#hasDependencies">hasDependencies</a></li><li data-type='method'><a href="Fetcher.html#performPostProcess">performPostProcess</a></li><li data-type='method'><a href="Fetcher.html#performPreProcess">performPreProcess</a></li><li data-type='method'><a href="Fetcher.html#postProcess">postProcess</a></li><li data-type='method'><a href="Fetcher.html#preProcess">preProcess</a></li><li data-type='method'><a href="Fetcher.html#setParameters">setParameters</a></li></ul></li><li><a href="IdentifiableObject.html">IdentifiableObject</a><ul class='methods'><li data-type='method'><a href="IdentifiableObject.html#get">get</a></li><li data-type='method'><a href="IdentifiableObject.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="IdentifiableObject.html#setParameters">setParameters</a></li><li data-type='method'><a href="IdentifiableObject.html#where">where</a></li></ul></li><li><a href="MultiFetcher.html">MultiFetcher</a><ul class='methods'><li data-type='method'><a href="MultiFetcher.html#addPostProcess">addPostProcess</a></li><li data-type='method'><a href="MultiFetcher.html#addPreProcess">addPreProcess</a></li><li data-type='method'><a href="MultiFetcher.html#get">get</a></li><li data-type='method'><a href="MultiFetcher.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="MultiFetcher.html#hasDependencies">hasDependencies</a></li><li data-type='method'><a href="MultiFetcher.html#performPostProcess">performPostProcess</a></li><li data-type='method'><a href="MultiFetcher.html#performPreProcess">performPreProcess</a></li><li data-type='method'><a href="MultiFetcher.html#postProcess">postProcess</a></li><li data-type='method'><a href="MultiFetcher.html#preProcess">preProcess</a></li><li data-type='method'><a href="MultiFetcher.html#setParameters">setParameters</a></li></ul></li><li><a href="Period.html">Period</a><ul class='methods'><li data-type='method'><a href="Period.html#setType">setType</a></li></ul></li><li><a href="Process.html">Process</a><ul class='methods'><li data-type='method'><a href="Process.html#addPostProcess">addPostProcess</a></li><li data-type='method'><a href="Process.html#addPreProcess">addPreProcess</a></li><li data-type='method'><a href="Process.html#hasDependencies">hasDependencies</a></li><li data-type='method'><a href="Process.html#performPostProcess">performPostProcess</a></li><li data-type='method'><a href="Process.html#performPreProcess">performPreProcess</a></li><li data-type='method'><a href="Process.html#postProcess">postProcess</a></li><li data-type='method'><a href="Process.html#preProcess">preProcess</a></li></ul></li><li><a href="ProgressPromise.html">ProgressPromise</a><ul class='methods'><li data-type='method'><a href="ProgressPromise.html#.all">all</a></li><li data-type='method'><a href="ProgressPromise.html#.sequence">sequence</a></li><li data-type='method'><a href="ProgressPromise.html#progress">progress</a></li></ul></li><li><a href="Row.html">Row</a><ul class='methods'><li data-type='method'><a href="Row.html#dimension">dimension</a></li></ul></li><li><a href="Runner.html">Runner</a><ul class='methods'><li data-type='method'><a href="Runner.html#.initiateRunner">initiateRunner</a></li><li data-type='method'><a href="Runner.html#getAllResults">getAllResults</a></li><li data-type='method'><a href="Runner.html#getResults">getResults</a></li></ul></li><li><a href="SQLViewData.html">SQLViewData</a><ul class='methods'><li data-type='method'><a href="SQLViewData.html#get">get</a></li><li data-type='method'><a href="SQLViewData.html#getDependecyFetchResults">getDependecyFetchResults</a></li><li data-type='method'><a href="SQLViewData.html#setParameters">setParameters</a></li><li data-type='method'><a href="SQLViewData.html#setVariable">setVariable</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#processCallback">processCallback</a></li><li><a href="global.html#rejectCallback">rejectCallback</a></li><li><a href="global.html#resolveCallback">resolveCallback</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">utilities/fetcher.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Runner } from './runner';
import { Process } from './process';
import ProgressPromise from 'progress-promise';

/**
 * Represents the fetcher process
 *@extends Process
 */
export class Fetcher extends Process {
  /**
   * Creates a fethcer
   * @constructor
   */
  constructor() {
    super();
    this.parameters = {};
  }

  /**
   * Gets the URL Parameters
   * @returns {string}
   * @private
   */
  get _urlParameters() {
    let url = '';

    Object.keys(this.parameters).forEach(key => {
      if (url !== '') {
        url += '&amp;';
      }
      if (typeof this.parameters[key] === 'string') {
        url += key + '=' + this.parameters[key];
      } else {
        Object.keys(this.parameters[key]).forEach(key2 => {
          if (url !== '') {
            url += '&amp;';
          }
          if (this.parameters[key][key2] === '') {
            url += key + '=' + key2;
          } else {
            url += key + '=' + key2 + ':' + this.parameters[key][key2];
          }
        });
      }
    });
    return url;
  }

  /**
   * Gets the url
   * @throws Implementation Error
   */
  get url() {
    throw new Error('Should implement url generation');
  }

  /**
   * Gets the running process started
   * @returns {ProgressPromise}
   */
  get() {
    return new Runner().getResults(this);
  }

  /**
   * Set paremeters
   * @param {Object} parameters - The parameters to be passed to the url
   * @returns {Fetcher} - Object of the fetcher
   */
  setParameters(parameters) {
    Object.keys(parameters).forEach(key => {
      this.parameters[key] = parameters[key];
    });
    return this;
  }

  /**
   * Get Dependency results
   * @returns {ProgressPromise}
   */
  getDependecyFetchResults() {
    const promises = this.dependencies.map(dependency => {
      return new Runner().getResults(dependency.process);
    });

    return ProgressPromise.all(promises);
  }
  _encode64(buff) {
    return btoa(new Uint8Array(buff).reduce((s, b) => s + String.fromCharCode(b), ''));
  }
  hash() {
    return this.url;
  }
}
</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Jul 17 2019 12:41:50 GMT+0300 (East Africa Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
